[if "inference_preset == 'none'"]
	[logs "Applying optimal inference settings for the Vivarium preset..."]
	[log]Checking if {get sd_model} is an inpainting model...[/log]
	[if "{info string_count='.inpainting.'}{get sd_model}{/info} > 0"]
		[log]Inpainting model detected - maxing out denoise strength.[/log]
		[sets denoising_strength=1.0][/if]
	[else][sets denoising_strength=0.67][/else]
	[sets cfg_scale=7.5 sampler_name="Restart" steps=20 mask_blur=4 mask_blur_x=4 mask_blur_y=4 inpaint_full_res=1 inpainting_fill=1 inpaint_full_res_padding=0 interrogate=0]
	[set negative_prompt _append]
		[get global_negative_prompt]
	[/set]
[/if]
[else]
	[logs "For optimal results with Vivarium, set your inference_preset to none" _level="warning"]
[/else]
[sets cn_0_enabled=1 cn_0_pixel_perfect=0 cn_0_model=instructp2p cn_0_weight=1.0 cn_0_control_mode=1 cn_0_guidance_end=0.2 cn_1_enabled=1 cn_1_pixel_perfect=1 cn_1_weight=0.33 cn_1_guidance_end=1.0 cn_1_module=reference_adain+attn cn_1_model=reference cn_1_mode=2]